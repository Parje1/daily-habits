<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Habit Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f9fafb;
            color: #374151;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }
        
        .header {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .title {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .title h1 {
            font-size: 2rem;
            font-weight: bold;
            color: #1f2937;
        }
        
        .progress {
            text-align: right;
        }
        
        .progress-number {
            font-size: 2rem;
            font-weight: bold;
            color: #2563eb;
        }
        
        .progress-text {
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        .nav-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        
        .nav-tab {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
        }
        
        .nav-tab.active {
            background-color: #2563eb;
            color: white;
        }
        
        .nav-tab:not(.active) {
            background-color: #f3f4f6;
            color: #374151;
        }
        
        .nav-tab:not(.active):hover {
            background-color: #e5e7eb;
        }
        
        .date-picker {
            margin-bottom: 2rem;
        }
        
        .date-picker label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }
        
        .date-picker input {
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 1rem;
        }
        
        .habits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .habit-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        
        .habit-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .habit-card.completed {
            background-color: #f0fdf4;
            border-color: #4ade80;
        }
        
        .habit-card.nutrition {
            border-color: #10b981;
            background-color: #f0fdf4;
        }
        
        .habit-card.fitness {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        
        .habit-card.wellness {
            border-color: #8b5cf6;
            background-color: #f5f3ff;
        }
        
        .habit-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .habit-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .habit-icon {
            font-size: 1.25rem;
        }
        
        .habit-name {
            font-weight: 500;
            color: #1f2937;
        }
        
        .habit-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #d1d5db;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .habit-checkbox.checked {
            background-color: #10b981;
            border-color: #10b981;
            color: white;
        }
        
        .streak {
            font-size: 0.75rem;
            color: #ea580c;
            font-weight: 600;
        }
        
        .analytics-section {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            padding: 2rem;
        }
        
        .analytics-header {
            background-color: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 2rem;
        }
        
        .analytics-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
            color: #92400e;
            margin-bottom: 0.5rem;
        }
        
        .analytics-description {
            font-size: 0.875rem;
            color: #78350f;
        }
        
        .habit-analysis {
            display: grid;
            gap: 1rem;
        }
        
        .habit-analysis-card {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 1.5rem;
        }
        
        .habit-analysis-card.struggling {
            border-color: #ef4444;
            background-color: #fef2f2;
        }
        
        .habit-analysis-card.excellent {
            border-color: #10b981;
            background-color: #f0fdf4;
        }
        
        .analysis-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .analysis-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .analysis-name {
            font-weight: 500;
            color: #1f2937;
        }
        
        .analysis-category {
            font-size: 0.75rem;
            color: #6b7280;
            text-transform: capitalize;
        }
        
        .success-rate {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .success-rate.low {
            color: #ef4444;
        }
        
        .success-rate.medium {
            color: #f59e0b;
        }
        
        .success-rate.high {
            color: #3b82f6;
        }
        
        .success-rate.excellent {
            color: #10b981;
        }
        
        .analysis-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            font-size: 0.875rem;
        }
        
        .stat-label {
            color: #6b7280;
        }
        
        .stat-value {
            font-weight: 500;
        }
        
        .tip {
            margin-top: 1rem;
            padding: 0.75rem;
            background-color: #fef2f2;
            border-radius: 6px;
            font-size: 0.875rem;
            color: #991b1b;
        }
        
        .weekly-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        
        .weekly-table th,
        .weekly-table td {
            padding: 0.75rem;
            text-align: center;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .weekly-table th:first-child,
        .weekly-table td:first-child {
            text-align: left;
        }
        
        .weekly-checkbox {
            width: 32px;
            height: 32px;
            border: 2px solid #d1d5db;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .weekly-checkbox.checked {
            background-color: #10b981;
            border-color: #10b981;
            color: white;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 0.5rem;
            }
            
            .header {
                padding: 1rem;
            }
            
            .title h1 {
                font-size: 1.5rem;
            }
            
            .habits-grid {
                grid-template-columns: 1fr;
            }
            
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .progress {
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="title">
                    <span style="font-size: 2rem;">🎯</span>
                    <h1>Habit Tracker</h1>
                </div>
                <div class="progress">
                    <div class="progress-text">Today's Progress</div>
                    <div class="progress-number" id="progress-count">0/12</div>
                    <div class="progress-text" id="progress-percentage">0% Complete</div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showView('today')">📅 Today</button>
            <button class="nav-tab" onclick="showView('weekly')">📊 Weekly</button>
            <button class="nav-tab" onclick="showView('analytics')">📈 Analytics</button>
        </div>

        <!-- Today View -->
        <div id="today-view">
            <div class="date-picker">
                <label for="date-input">Select Date:</label>
                <input type="date" id="date-input" onchange="updateDate()">
            </div>
            
            <div class="habits-grid" id="habits-grid">
                <!-- Habits will be populated by JavaScript -->
            </div>
        </div>

        <!-- Weekly View -->
        <div id="weekly-view" style="display: none;">
            <div class="analytics-section">
                <h2 style="margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                    📊 Weekly Progress
                </h2>
                <table class="weekly-table" id="weekly-table">
                    <!-- Weekly table will be populated by JavaScript -->
                </table>
            </div>
        </div>

        <!-- Analytics View -->
        <div id="analytics-view" style="display: none;">
            <div class="analytics-section">
                <div class="analytics-header">
                    <div class="analytics-title">
                        ⚠️ Habits Needing Attention
                    </div>
                    <div class="analytics-description">
                        Focus on the habits with lower success rates to improve your overall consistency.
                    </div>
                </div>
                
                <div class="habit-analysis" id="habit-analysis">
                    <!-- Analytics will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Habit data
        const habits = [
            { id: 'breakfast', name: 'Breakfast (30g protein)', category: 'nutrition', target: 'daily', icon: '🥗' },
            { id: 'lunch', name: 'Lunch (30g protein)', category: 'nutrition', target: 'daily', icon: '🥗' },
            { id: 'dinner', name: 'Dinner (30g protein)', category: 'nutrition', target: 'daily', icon: '🥗' },
            { id: 'snack', name: 'Snack (25g protein)', category: 'nutrition', target: 'daily', icon: '🥗' },
            { id: 'no_food_730', name: 'No food after 7:30pm', category: 'nutrition', target: 'daily', icon: '🥗' },
            { id: 'exercise', name: 'Hour Exercise/9,000 steps', category: 'fitness', target: 'daily', icon: '💪' },
            { id: 'yoga', name: 'Yoga', category: 'fitness', target: '2x/week', icon: '💪' },
            { id: 'strength', name: 'Strength Training', category: 'fitness', target: '2x/week', icon: '💪' },
            { id: 'meditation', name: 'Meditation', category: 'wellness', target: 'daily', icon: '🧘' },
            { id: 'spiritual', name: 'Spiritual time', category: 'wellness', target: 'daily', icon: '🧘' },
            { id: 'bed_1030', name: 'Bed by 10:30pm', category: 'wellness', target: 'daily', icon: '🧘' },
            { id: 'water', name: 'Water 120 oz', category: 'nutrition', target: 'daily', icon: '🥗' }
        ];

        // State
        let completedHabits = {};
        let selectedDate = new Date().toISOString().split('T')[0];
        let currentView = 'today';

        // Load data from localStorage
        function loadData() {
            try {
                const saved = localStorage.getItem('habitTrackerData');
                if (saved) {
                    completedHabits = JSON.parse(saved);
                }
            } catch (error) {
                console.warn('Failed to load data:', error);
                completedHabits = {};
            }
        }

        // Save data to localStorage
        function saveData() {
            try {
                localStorage.setItem('habitTrackerData', JSON.stringify(completedHabits));
            } catch (error) {
                console.warn('Failed to save data:', error);
            }
        }

        // Toggle habit completion
        function toggleHabit(habitId, date) {
            const key = `${habitId}_${date}`;
            completedHabits[key] = !completedHabits[key];
            saveData();
            updateViews();
        }

        // Check if habit is completed
        function isHabitCompleted(habitId, date) {
            const key = `${habitId}_${date}`;
            return completedHabits[key] || false;
        }

        // Get completion count for a date
        function getCompletedCount(date) {
            return habits.filter(habit => isHabitCompleted(habit.id, date)).length;
        }

        // Get completion percentage
        function getCompletionPercentage(date) {
            return Math.round((getCompletedCount(date) / habits.length) * 100);
        }

        // Get last N days
        function getLastNDays(n) {
            const days = [];
            for (let i = n - 1; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                days.push(date.toISOString().split('T')[0]);
            }
            return days;
        }

        // Get habit success rate
        function getHabitSuccessRate(habitId, days = 30) {
            const lastNDays = getLastNDays(days);
            const completed = lastNDays.filter(date => isHabitCompleted(habitId, date)).length;
            return Math.round((completed / lastNDays.length) * 100);
        }

        // Get streak info
        function getStreakInfo(habitId) {
            let currentStreak = 0;
            let longestStreak = 0;
            let tempStreak = 0;
            
            const last100Days = getLastNDays(100);
            
            // Current streak (from today backwards)
            for (let i = 0; i < last100Days.length; i++) {
                if (isHabitCompleted(habitId, last100Days[last100Days.length - 1 - i])) {
                    currentStreak++;
                } else {
                    break;
                }
            }
            
            // Longest streak
            for (const date of last100Days) {
                if (isHabitCompleted(habitId, date)) {
                    tempStreak++;
                    longestStreak = Math.max(longestStreak, tempStreak);
                } else {
                    tempStreak = 0;
                }
            }
            
            return { currentStreak, longestStreak };
        }

        // Format date
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { 
                weekday: 'short', 
                month: 'short', 
                day: 'numeric' 
            });
        }

        // Update date
        function updateDate() {
            selectedDate = document.getElementById('date-input').value;
            updateViews();
        }

        // Show view
        function showView(view) {
            currentView = view;
            
            // Update nav tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Show/hide views
            document.getElementById('today-view').style.display = view === 'today' ? 'block' : 'none';
            document.getElementById('weekly-view').style.display = view === 'weekly' ? 'block' : 'none';
            document.getElementById('analytics-view').style.display = view === 'analytics' ? 'block' : 'none';
            
            updateViews();
        }

        // Update all views
        function updateViews() {
            updateProgress();
            if (currentView === 'today') {
                updateTodayView();
            } else if (currentView === 'weekly') {
                updateWeeklyView();
            } else if (currentView === 'analytics') {
                updateAnalyticsView();
            }
        }

        // Update progress display
        function updateProgress() {
            const count = getCompletedCount(selectedDate);
            const percentage = getCompletionPercentage(selectedDate);
            document.getElementById('progress-count').textContent = `${count}/${habits.length}`;
            document.getElementById('progress-percentage').textContent = `${percentage}% Complete`;
        }

        // Update today view
        function updateTodayView() {
            const grid = document.getElementById('habits-grid');
            grid.innerHTML = '';
            
            habits.forEach(habit => {
                const { currentStreak } = getStreakInfo(habit.id);
                const completed = isHabitCompleted(habit.id, selectedDate);
                
                const card = document.createElement('div');
                card.className = `habit-card ${habit.category} ${completed ? 'completed' : ''}`;
                card.onclick = () => toggleHabit(habit.id, selectedDate);
                
                card.innerHTML = `
                    <div class="habit-header">
                        <div class="habit-info">
                            <span class="habit-icon">${habit.icon}</span>
                            <span class="habit-name">${habit.name}</span>
                        </div>
                        <div class="habit-checkbox ${completed ? 'checked' : ''}">
                            ${completed ? '✓' : ''}
                        </div>
                    </div>
                    ${currentStreak > 0 ? `<div class="streak">🔥 ${currentStreak} day streak</div>` : ''}
                `;
                
                grid.appendChild(card);
            });
        }

        // Update weekly view
        function updateWeeklyView() {
            const table = document.getElementById('weekly-table');
            const weekDays = getLastNDays(7);
            
            let html = '<thead><tr><th>Habit</th>';
            weekDays.forEach(date => {
                html += `<th>${formatDate(date)}</th>`;
            });
            html += '<th>Success</th></tr></thead><tbody>';
            
            habits.forEach(habit => {
                const weekSuccess = Math.round((weekDays.filter(date => isHabitCompleted(habit.id, date)).length / 7) * 100);
                html += `<tr><td><span class="habit-icon">${habit.icon}</span> ${habit.name}</td>`;
                
                weekDays.forEach(date => {
                    const completed = isHabitCompleted(habit.id, date);
                    html += `<td><div class="weekly-checkbox ${completed ? 'checked' : ''}" onclick="toggleHabit('${habit.id}', '${date}')">${completed ? '✓' : ''}</div></td>`;
                });
                
                const successClass = weekSuccess >= 85 ? 'excellent' : weekSuccess >= 60 ? 'medium' : 'low';
                html += `<td><span class="success-rate ${successClass}">${weekSuccess}%</span></td></tr>`;
            });
            
            html += '</tbody>';
            table.innerHTML = html;
        }

        // Update analytics view
        function updateAnalyticsView() {
            const container = document.getElementById('habit-analysis');
            const analytics = habits.map(habit => ({
                ...habit,
                successRate: getHabitSuccessRate(habit.id, 30),
                totalDays: 30,
                completedDays: getLastNDays(30).filter(date => isHabitCompleted(habit.id, date)).length
            })).sort((a, b) => a.successRate - b.successRate);
            
            container.innerHTML = '';
            
            analytics.forEach((habit, index) => {
                const { currentStreak, longestStreak } = getStreakInfo(habit.id);
                const isStrugglingWith = habit.successRate < 70;
                
                const card = document.createElement('div');
                card.className = `habit-analysis-card ${isStrugglingWith ? 'struggling' : habit.successRate > 90 ? 'excellent' : ''}`;
                
                const successClass = habit.successRate < 50 ? 'low' : 
                                   habit.successRate < 70 ? 'medium' : 
                                   habit.successRate < 90 ? 'high' : 'excellent';
                
                const priority = index < 3 ? '🔴 High' : index < 6 ? '🟡 Medium' : '🟢 Low';
                
                card.innerHTML = `
                    <div class="analysis-header">
                        <div class="analysis-info">
                            <span class="habit-icon">${habit.icon}</span>
                            <div>
                                <div class="analysis-name">${habit.name}</div>
                                <div class="analysis-category">${habit.target} • ${habit.category}</div>
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <div class="success-rate ${successClass}">${habit.successRate}%</div>
                            <div class="progress-text">${habit.completedDays}/${habit.totalDays} days</div>
                        </div>
                    </div>
                    
                    <div class="analysis-stats">
                        <div>
                            <div class="stat-label">Current Streak</div>
                            <div class="stat-value">${currentStreak} days</div>
                        </div>
                        <div>
                            <div class="stat-label">Best Streak</div>
                            <div class="stat-value">${longestStreak} days</div>
                        </div>
                        <div>
                            <div class="stat-label">Priority</div>
                            <div class="stat-value">${priority}</div>
                        </div>
                    </div>
                    
                    ${isStrugglingWith ? '<div class="tip">💡 Consider: What\'s making this habit challenging? Could you break it into smaller steps?</div>' : ''}
                `;
                
                container.appendChild(card);
            });
        }

        // Initialize app
        function init() {
            loadData();
            document.getElementById('date-input').value = selectedDate;
            updateViews();
        }

        // Start the app when page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>